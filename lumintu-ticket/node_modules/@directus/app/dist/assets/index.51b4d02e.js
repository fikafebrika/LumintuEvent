var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,i=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&r(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&r(e,a,t[a]);return e};"undefined"!=typeof require&&require;import{n as l,u as c,o as u,y as d,B as v,z as p,r as f,K as m,L as y,q as g,t as b,w as _,C as h,v as k,J as w,aD as O,D as $,F as I,O as S,E as x,I as L,H as j,l as P,G as C,ax as N,an as B,Q as U,U as A,aF as M,Z as V,X as E,P as F,S as q,T as D,M as T,N as H}from"./vendor.162b55e9.js";import{u as G,a as Q,_ as R,b as J,g as K,c as W,M as z,t as X,d as Z,e as Y,f as ee,h as te,i as ae,j as ne,H as oe,k as se}from"../index.b5755817.js";import"./use-sync.6d51d5e5.js";const re=l({setup(){const{t:e}=c(),t=G(),a=Q(),n=u((()=>{var e;return null===a.settings?null:(null==(e=a.settings)?void 0:e.project_logo)?J(K()+`assets/${a.settings.project_logo}`):null})),o=d(!1),{queueHasItems:s}=v(t);p((()=>s.value),(e=>{e&&(o.value=!0)}));const r=u((()=>{var e;return null==(e=a.settings)?void 0:e.project_url})),i=u((()=>{var t;return!!(null==(t=a.settings)?void 0:t.project_url)&&e("view_project")}));return{customLogoPath:n,showLoader:o,stopSpinnerIfQueueIsEmpty:function(){!1===s.value&&(o.value=!1)},url:r,urlTooltip:i}}}),ie=["src"];var le=R(re,[["render",function(e,t,a,n,o,s){const r=f("v-progress-linear"),i=m("tooltip");return y((g(),b(x(e.url?"a":"div"),{ref:"noopener noreferer",href:e.url,target:"_blank",class:S(["module-bar-logo",{loading:e.showLoader}])},{default:_((()=>[e.customLogoPath?(g(),h(I,{key:0},[k(O,{name:"fade"},{default:_((()=>[e.showLoader?(g(),b(r,{key:0,indeterminate:"",rounded:"",onAnimationiteration:e.stopSpinnerIfQueueIsEmpty},null,8,["onAnimationiteration"])):w("",!0)])),_:1}),$("img",{class:"custom-logo",src:e.customLogoPath,alt:"Project Logo"},null,8,ie)],64)):(g(),h("div",{key:1,class:S(["logo",{running:e.showLoader}]),onAnimationiteration:t[0]||(t[0]=(...t)=>e.stopSpinnerIfQueueIsEmpty&&e.stopSpinnerIfQueueIsEmpty(...t))},null,34))])),_:1},8,["href","class"])),[[i,e.urlTooltip,void 0,{right:!0}]])}],["__scopeId","data-v-5c883768"]]);const ce=l({setup(){const{t:e}=c(),t=W(),a=d(!1),n=u((()=>null===t.currentUser||null===t.currentUser.avatar?null:J(K()+`assets/${t.currentUser.avatar.id}?key=system-medium-cover`))),o=u((()=>{var e;return`/users/${null==(e=t.currentUser)?void 0:e.id}`})),s=u((()=>"/logout"));return{t:e,userFullName:t.fullName,avatarURL:n,userProfileLink:o,signOutActive:a,signOutLink:s}}}),ue=["src","alt"];const de=l({components:{ModuleBarLogo:le,ModuleBarAvatar:R(ce,[["render",function(e,t,a,n,o,s){const r=f("v-icon"),i=f("v-button"),l=f("v-card-title"),c=f("v-card-actions"),u=f("v-card"),d=f("v-dialog"),v=f("v-avatar"),p=f("router-link"),w=f("v-hover"),O=m("tooltip");return g(),b(w,{class:"module-bar-avatar"},{default:_((({hover:a})=>[k(d,{modelValue:e.signOutActive,"onUpdate:modelValue":t[1]||(t[1]=t=>e.signOutActive=t),onEsc:t[2]||(t[2]=t=>e.signOutActive=!1)},{activator:_((({on:t})=>[y(k(i,{tile:"",icon:"","x-large":"",class:S([{show:a},"sign-out"]),onClick:t},{default:_((()=>[k(r,{name:"logout"})])),_:2},1032,["class","onClick"]),[[O,e.t("sign_out"),void 0,{right:!0}]])])),default:_((()=>[k(u,null,{default:_((()=>[k(l,null,{default:_((()=>[L(j(e.t("sign_out_confirm")),1)])),_:1}),k(c,null,{default:_((()=>[k(i,{secondary:"",onClick:t[0]||(t[0]=t=>e.signOutActive=!e.signOutActive)},{default:_((()=>[L(j(e.t("cancel")),1)])),_:1}),k(i,{to:e.signOutLink},{default:_((()=>[L(j(e.t("sign_out")),1)])),_:1},8,["to"])])),_:1})])),_:1})])),_:2},1032,["modelValue"]),k(p,{to:e.userProfileLink},{default:_((()=>[y(k(v,{tile:"",large:"",class:S({"no-avatar":!e.avatarURL})},{default:_((()=>[e.avatarURL?(g(),h("img",{key:0,src:e.avatarURL,alt:e.userFullName,class:"avatar-image"},null,8,ue)):(g(),b(r,{key:1,name:"account_circle",outline:""}))])),_:1},8,["class"]),[[O,e.userFullName,void 0,{right:!0}]])])),_:1},8,["to"])])),_:1})}],["__scopeId","data-v-4fec1dae"]])},setup(){const e=Q(),{modules:n}=Z(),o=u((()=>n.value.map((e=>e.id))));return{modules:u((()=>{var s;return e.settings?(null!=(s=e.settings.module_bar)?s:z).filter((e=>"link"===e.type||e.enabled&&o.value.includes(e.id))).map((e=>{if("link"===e.type){const t=P.exports.omit(e,["url"]);return e.url.startsWith("/")?t.to=e.url:t.href=e.url,X(t)}const o=n.value.find((t=>t.id===e.id));return s=i(i({},e),n.value.find((t=>t.id===e.id))),r={to:void 0===o.link?`/${o.id}`:""},t(s,a(r));var s,r})):[]}))}}}),ve={class:"module-bar"},pe={class:"modules"};var fe=R(de,[["render",function(e,t,a,n,o,s){const r=f("module-bar-logo"),i=f("v-icon"),l=f("v-button"),c=f("module-bar-avatar"),u=m("tooltip");return g(),h("div",ve,[k(r),$("div",pe,[(g(!0),h(I,null,C(e.modules,(e=>y((g(),b(l,{key:e.id,icon:"","x-large":"",to:e.to,href:e.href,tile:"",style:N(e.color?{"--v-button-color-active":e.color}:null)},{default:_((()=>[k(i,{name:e.icon,outline:""},null,8,["name"])])),_:2},1032,["to","href","style"])),[[u,e.name,void 0,{right:!0}]]))),128))]),k(c)])}],["__scopeId","data-v-66091604"]]);var me=R(l({props:{sidebarOpen:{type:Boolean,default:!1}},setup(e){const t=d([]),a=d(!1);return p((()=>e.sidebarOpen),(async e=>{!1===e?t.value=[]:(a.value=!0,await B(),a.value=!1)})),{openDetail:t,mandatory:a}}}),[["render",function(e,t,a,n,o,s){const r=f("v-item-group");return g(),b(r,{modelValue:e.openDetail,"onUpdate:modelValue":t[0]||(t[0]=t=>e.openDetail=t),class:"sidebar-detail-group",scope:"sidebar-detail",mandatory:e.mandatory},{default:_((()=>[U(e.$slots,"default",{},void 0,!0)])),_:3},8,["modelValue","mandatory"])}],["__scopeId","data-v-ebb6371e"]]),ye=1e3,ge=60*ye,be=60*ge,_e=24*be,he=7*_e,ke=365.25*_e,we=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*ke;case"weeks":case"week":case"w":return a*he;case"days":case"day":case"d":return a*_e;case"hours":case"hour":case"hrs":case"hr":case"h":return a*be;case"minutes":case"minute":case"mins":case"min":case"m":return a*ge;case"seconds":case"second":case"secs":case"sec":case"s":return a*ye;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=_e)return Oe(e,t,_e,"day");if(t>=be)return Oe(e,t,be,"hour");if(t>=ge)return Oe(e,t,ge,"minute");if(t>=ye)return Oe(e,t,ye,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=_e)return Math.round(e/_e)+"d";if(t>=be)return Math.round(e/be)+"h";if(t>=ge)return Math.round(e/ge)+"m";if(t>=ye)return Math.round(e/ye)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Oe(e,t,a,n){var o=t>=1.5*a;return Math.round(e/a)+" "+n+(o?"s":"")}const $e=l({setup(){const{t:e}=c(),t=Y(),a=u((()=>{const e=P.exports.sortBy(t.latency,["timestamp"]);return e[e.length-1]})),n=u((()=>{if(!t.latency||0===t.latency.length)return 0;const e=P.exports.sortBy(t.latency,["timestamp"]),a=e.slice(Math.max(e.length-5,0));let n=0;for(const{latency:t}of a)n+=t;return Math.round(n/a.length)})),o=u((()=>n.value<=250?4:n.value>250&&n.value<=500?3:n.value>500&&n.value<=750?2:1)),s=u((()=>{switch(o.value){case 4:return`${e("connection_excellent")}\n(${we(n.value)} ${e("latency")})`;case 3:return`${e("connection_good")}\n(${we(n.value)} ${e("latency")})`;case 2:return`${e("connection_fair")}\n(${we(n.value)} ${e("latency")})`;case 1:return`${e("connection_poor")}\n(${we(n.value)} ${e("latency")})`;default:return null}}));return{icon:u((()=>{switch(o.value){case 4:return"signal_wifi_4_bar";case 3:return"signal_wifi_3_bar";case 2:return"signal_wifi_2_bar";case 1:return"signal_wifi_1_bar";default:return null}})),lastLatency:a,latencyTooltip:s}}}),Ie={class:"latency-indicator"};const Se=l({components:{LatencyIndicator:R($e,[["render",function(e,t,a,n,o,s){const r=f("v-progress-circular"),i=f("v-icon"),l=m("tooltip");return y((g(),h("div",Ie,[e.lastLatency?(g(),b(i,{key:1,name:e.icon},null,8,["name"])):(g(),b(r,{key:0,indeterminate:""}))],512)),[[l,e.latencyTooltip,void 0,{bottom:!0,end:!0}]])}],["__scopeId","data-v-2cfd5c8b"]])},setup(){const e=ee();return{name:u((()=>{var t,a;return null==(a=null==(t=e.info)?void 0:t.project)?void 0:a.project_name}))}}}),xe={class:"project-info"},Le={class:"name"};var je=R(Se,[["render",function(e,t,a,n,o,s){const r=f("latency-indicator");return g(),h("div",xe,[k(r),$("span",Le,j(e.name),1)])}],["__scopeId","data-v-08488eb6"]]);const Pe=l({props:{id:{type:String,required:!0},title:{type:String,required:!0},text:{type:String,default:null},icon:{type:String,default:null},type:{type:String,default:"info",validator:e=>["info","success","warning","error"].includes(e)},tail:{type:Boolean,default:!1},dense:{type:Boolean,default:!1},showClose:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},progress:{type:Number,default:void 0}},setup(e){const t=te();return{close:function(){!0===e.showClose&&t.remove(e.id)}}}}),Ce={key:0,class:"icon"},Ne={class:"content"},Be={class:"title selectable"},Ue={key:0,class:"text selectable"};var Ae=R(Pe,[["render",function(e,t,a,n,o,s){const r=f("v-progress-circular"),i=f("v-icon");return g(),h("div",{class:S(["notification-item",[e.type,{tail:e.tail,dense:e.dense}]]),onClick:t[0]||(t[0]=(...t)=>e.close&&e.close(...t))},[e.loading||e.progress||e.icon?(g(),h("div",Ce,[e.loading?(g(),b(r,{key:0,indeterminate:"",small:""})):e.progress?(g(),b(r,{key:1,small:"",value:e.progress},null,8,["value"])):(g(),b(i,{key:2,name:e.icon},null,8,["name"]))])):w("",!0),$("div",Ne,[$("p",Be,j(e.title),1),e.text?(g(),h("p",Ue,j(e.text),1)):w("",!0)]),e.showClose?(g(),b(i,{key:1,name:"close",clickable:"",class:"close",onClick:e.close},null,8,["onClick"])):w("",!0)],2)}],["__scopeId","data-v-5b51205c"]]);var Me=R(l({components:{NotificationItem:Ae},props:{dense:{type:Boolean,default:!1}},setup(){const e=te();return{queue:v(e).queue}}}),[["render",function(e,t,a,n,o,s){const r=f("notification-item");return g(),b(M,{class:"notifications-group",name:"slide-fade",tag:"div"},{default:_((()=>[U(e.$slots,"default",{},void 0,!0),(g(!0),h(I,null,C(e.queue,((t,a)=>(g(),b(r,A({key:t.id},t,{tail:a===e.queue.length-1,dense:e.dense,"show-close":!0===t.persist&&!1!==t.closeable}),null,16,["tail","dense","show-close"])))),128))])),_:3})}],["__scopeId","data-v-31bc6bbb"]]);const Ve=l({props:{to:{type:String,default:null},icon:{type:String,default:"box"},active:{type:Boolean,default:!1}},emits:["click"],setup(){const e=ae(),{sidebarOpen:t}=v(e);return{sidebarOpen:t}}}),Ee={class:"icon"},Fe={key:0,class:"title"};const qe=l({components:{SidebarButton:R(Ve,[["render",function(e,t,a,n,o,s){const r=f("v-icon");return g(),b(x(e.to?"router-link":"button"),{class:S(["sidebar-button",{active:e.active}]),onClick:t[0]||(t[0]=t=>e.$emit("click",t))},{default:_((()=>[$("div",Ee,[k(r,{name:e.icon,outline:""},null,8,["name"])]),e.sidebarOpen?(g(),h("div",Fe,[U(e.$slots,"default",{},void 0,!0)])):w("",!0)])),_:3},8,["class"])}],["__scopeId","data-v-3f4d4d50"]]),NotificationItem:Ae},props:{sidebarOpen:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(){const{t:e}=c();return{t:e,lastFour:te().lastFour}}}),De={class:"notifications-preview"},Te={key:0,class:"inline"},He={class:"padding-box"};var Ge=R(qe,[["render",function(e,t,a,n,o,s){const r=f("router-link"),i=f("notification-item"),l=f("transition-expand"),c=f("sidebar-button"),u=m("tooltip");return g(),h("div",De,[k(l,{tag:"div"},{default:_((()=>[e.modelValue?(g(),h("div",Te,[$("div",He,[k(r,{class:S(["link",{"has-items":e.lastFour.length>0}]),to:"/activity"},{default:_((()=>[L(j(e.t("show_all_activity")),1)])),_:1},8,["class"]),k(M,{tag:"div",name:"notification",class:"transition"},{default:_((()=>[(g(!0),h(I,null,C(e.lastFour,(e=>(g(),b(i,A({key:e.id},e),null,16)))),128))])),_:1})])])):w("",!0)])),_:1}),y(k(c,{active:e.modelValue,class:"toggle",icon:"notifications",onClick:t[0]||(t[0]=t=>e.$emit("update:modelValue",!e.modelValue))},{default:_((()=>[L(j(e.t("notifications")),1)])),_:1},8,["active"]),[[u,e.t("notifications"),void 0,{left:!0}]])])}],["__scopeId","data-v-8ca41ff4"]]);const Qe=l({setup(){const{t:e}=c(),{parsedInfo:t}=ne(),a=te(),n=W();return{t:e,notifications:u((()=>a.dialogs)),admin:n.isAdmin,done:function(e){a.remove(e)},getGitHubIssueLink:function(e,a){var n,o,s,r;const i=`\x3c!-- Please put a detailed explanation of the problem here. --\x3e\n\n---\n\n### Project details\nDirectus Version: ${null==(n=t.value)?void 0:n.directus.version}\nEnvironment: production\nOS: ${null==(o=t.value)?void 0:o.os.type} ${null==(s=t.value)?void 0:s.os.version}\nNode: ${null==(r=t.value)?void 0:r.node.version}\n\n### Error\n\nTitle: ${a.title||"none"}\nMessage: ${a.text||"none"}\n\n<details>\n<summary>Stack Trace</summary>\n<pre>\n${JSON.stringify(a.error,Object.getOwnPropertyNames(a.error),2)}\n</pre>\n</details>\n\t\t\t`;return`https://github.com/directus/directus/issues/new?body=${encodeURIComponent(i)}`}}}}),Re={class:"notification-dialogs"},Je=["href"];const Ke=l({components:{ModuleBar:fe,SidebarDetailGroup:me,HeaderBar:oe,ProjectInfo:je,NotificationsGroup:Me,NotificationsPreview:Ge,NotificationDialogs:R(Qe,[["render",function(e,t,a,n,o,s){const r=f("v-card-title"),i=f("v-error"),l=f("v-card-text"),c=f("v-button"),u=f("v-card-actions"),d=f("v-card"),v=f("v-dialog");return g(),h("div",Re,[(g(!0),h(I,null,C(e.notifications,(t=>(g(),b(v,{key:t.id,"model-value":!0,persist:""},{default:_((()=>[k(d,{class:S([t.type])},{default:_((()=>[k(r,null,{default:_((()=>[L(j(t.title),1)])),_:2},1024),t.text?(g(),b(l,{key:0},{default:_((()=>[L(j(t.text)+" ",1),t.error?(g(),b(i,{key:0,error:t.error},null,8,["error"])):w("",!0)])),_:2},1024)):w("",!0),k(u,null,{default:_((()=>["error"===t.type&&e.admin&&"UNKNOWN"===t.code?(g(),b(c,{key:0,secondary:""},{default:_((()=>[$("a",{target:"_blank",href:e.getGitHubIssueLink(t.id,t)},j(e.t("report_error")),9,Je)])),_:2},1024)):w("",!0),k(c,{onClick:a=>e.done(t.id)},{default:_((()=>[L(j(e.t("dismiss")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["class"])])),_:2},1024)))),128))])}],["__scopeId","data-v-bb61b36a"]])},props:{title:{type:String,default:null},smallHeader:{type:Boolean,default:!1}},setup(e){const{t:t}=c(),a=V(),{title:n}=v(e),o=d(!1),s=d(),r=W(),i=ae(),l=u((()=>{var e,t;return!r.currentUser||((null==(t=null==(e=r.currentUser)?void 0:e.role)?void 0:t.app_access)||!1)})),p=d(!1),{sidebarOpen:f,fullScreen:m}=v(i),y=u((()=>{var e;return(null==(e=r.currentUser)?void 0:e.theme)||"auto"}));return E("main-element",s),a.afterEach((async()=>{var e;null==(e=s.value)||e.scrollTo({top:0}),m.value=!1})),se(n),{t:t,navOpen:o,contentEl:s,theme:y,sidebarOpen:f,openSidebar:function(e){e.target&&!1===e.target.classList.contains("close")&&(f.value=!0)},notificationsPreviewActive:p,appAccess:l,fullScreen:m}}}),We=e=>(T("data-v-d2b7ab78"),e=e(),H(),e),ze=L("Switch User"),Xe={class:"module-nav alt-colors"},Ze={class:"module-nav-content"},Ye={id:"main-content",ref:"contentEl",class:"content"},et={class:"flex-container"},tt=We((()=>$("div",{class:"spacer"},null,-1)));var at=R(Ke,[["render",function(e,t,a,n,o,s){const r=f("v-button"),i=f("v-info"),l=f("module-bar"),c=f("project-info"),u=f("header-bar"),d=f("sidebar-detail-group"),v=f("notifications-preview"),p=f("v-overlay"),m=f("notifications-group"),y=f("notification-dialogs");return!1===e.appAccess?(g(),b(i,{key:0,center:"",title:e.t("no_app_access"),type:"danger",icon:"block"},{append:_((()=>[k(r,{to:"/logout"},{default:_((()=>[ze])),_:1})])),default:_((()=>[L(j(e.t("no_app_access_copy"))+" ",1)])),_:1},8,["title"])):(g(),h("div",{key:1,class:S(["private-view",{theme:e.theme,"full-screen":e.fullScreen}])},[$("aside",{id:"navigation",role:"navigation","aria-label":"Module Navigation",class:S({"is-open":e.navOpen})},[k(l),$("div",Xe,[k(c),$("div",Ze,[U(e.$slots,"navigation",{},void 0,!0)])])],2),$("div",Ye,[k(u,{small:e.smallHeader,"show-sidebar-toggle":"",title:e.title,"onToggle:sidebar":t[0]||(t[0]=t=>e.sidebarOpen=!e.sidebarOpen),onPrimary:t[1]||(t[1]=t=>e.navOpen=!e.navOpen)},F({_:2},[C(e.$slots,((t,a)=>({name:a,fn:_((t=>[U(e.$slots,a,q(D(t)),void 0,!0)]))})))]),1032,["small","title"]),$("main",null,[U(e.$slots,"default",{},void 0,!0)])],512),$("aside",{id:"sidebar",role:"contentinfo",class:S(["alt-colors",{"is-open":e.sidebarOpen}]),"aria-label":"Module Sidebar",onClick:t[3]||(t[3]=(...t)=>e.openSidebar&&e.openSidebar(...t))},[$("div",et,[k(d,{"sidebar-open":e.sidebarOpen},{default:_((()=>[U(e.$slots,"sidebar",{},void 0,!0)])),_:3},8,["sidebar-open"]),tt,k(v,{modelValue:e.notificationsPreviewActive,"onUpdate:modelValue":t[2]||(t[2]=t=>e.notificationsPreviewActive=t),"sidebar-open":e.sidebarOpen},null,8,["modelValue","sidebar-open"])])],2),k(p,{class:"nav-overlay",active:e.navOpen,onClick:t[4]||(t[4]=t=>e.navOpen=!1)},null,8,["active"]),k(p,{class:"sidebar-overlay",active:e.sidebarOpen,onClick:t[5]||(t[5]=t=>e.sidebarOpen=!1)},null,8,["active"]),!1===e.notificationsPreviewActive?(g(),b(m,{key:0,dense:!1===e.sidebarOpen},null,8,["dense"])):w("",!0),k(y)],2))}],["__scopeId","data-v-d2b7ab78"]]);export{at as PrivateView,at as default};
