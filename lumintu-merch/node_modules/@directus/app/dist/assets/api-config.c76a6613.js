import{r as n,p as l,q as c,w as a,B as e,t as u,P as t}from"./vendor.a626ab9c.js";const h={class:"markdown-body"},_=e("p",null,[e("div",{class:"table-of-contents"},[e("ul",null,[e("li",null,[e("a",{href:"#cache"},"Cache")]),e("li",null,[e("a",{href:"#auth"},"Auth")]),e("li",null,[e("a",{href:"#file-storage"},"File Storage")]),e("li",null,[e("a",{href:"#rate-limiting"},"Rate Limiting")]),e("li",null,[e("a",{href:"#file-based-configuration"},"File-Based Configuration")])])])],-1),d=e("h2",{id:"cache"},[t("Cache "),e("a",{class:"header-anchor",href:"#cache"},"#")],-1),p=e("p",null,"Directus has a built-in way to do data-caching. Enabling this will cache the output of the request (based on the current user and exact query parameters used) into to configured cache storage location. This will drastically improve API performance, as subsequent requests are served straight from this cache. Enabling cache will also make Directus return accurate cache-control headers. Depending on your setup, this will further improve performance by caching the request in middleman servers (like CDNs) and even the browser.",-1),f=e("p",null,[t("You can enable the data-cache with the "),e("code",null,"CACHE_ENABLED"),t(" environment variable.")],-1),T=e("h3",{id:"cache-store"},[t("Cache Store "),e("a",{class:"header-anchor",href:"#cache-store"},"#")],-1),E=e("p",null,[t("In bigger projects, you most likely don\u2019t want to rely on local memory to keep the caches. Instead, you can use the "),e("code",null,"CACHE_STORE"),t(" environment variable to tell Directus to use either "),e("code",null,"memcache"),t(" or "),e("code",null,"redis"),t(" to store the caches.")],-1),g=e("pre",null,[e("code",null,`CACHE_ENABLED="true"

CACHE_STORE="redis"
CACHE_REDIS="redis://@127.0.0.1"
`)],-1),A=e("h3",{id:"auto-purging"},[t("Auto-Purging "),e("a",{class:"header-anchor",href:"#auto-purging"},"#")],-1),m=e("p",null,"Directus can automatically clear the caches whenever a create/update/delete action is performed. This allows you to keep the Directus API real-time, while still getting the performance benefits on quick subsequent reads.",-1),R=e("pre",null,[e("code",null,`CACHE_AUTO_PURGE="true"
`)],-1),O=e("h3",{id:"ttl"},[t("TTL "),e("a",{class:"header-anchor",href:"#ttl"},"#")],-1),I=e("p",null,[t("Based on your project\u2019s needs, you might be able to aggressively cache your data, only requiring new data to be fetched every hour or so. This allows you to squeeze the most performance out of your Directus instance. This can be incredibly useful for applications where you have a lot of (public) read-access and where updates aren\u2019t real-time (for example a website). "),e("code",null,"CACHE_TTL"),t(" uses "),e("a",{href:"https://www.npmjs.com/package/ms",target:"_blank",rel:"noopener noreferrer"},[e("code",null,"ms")]),t(" to parse the value, so you configure it using human readable values (like "),e("code",null,"2 days"),t(", "),e("code",null,"7 hrs"),t(", "),e("code",null,"5m"),t(").")],-1),b=e("pre",null,[e("code",null,`CACHE_TTL="1h"
`)],-1),L=e("h3",{id:"assets"},[t("Assets "),e("a",{class:"header-anchor",href:"#assets"},"#")],-1),C=e("p",null,"The cache-control header for the /assets endpoint is separate from the regular data-cache. This is useful as it\u2019s often possible to cache assets for way longer than you would with the actual content.",-1),S=e("pre",null,[e("code",null,`ASSETS_CACHE_TTL="7d"
`)],-1),y=e("h2",{id:"auth"},[t("Auth "),e("a",{class:"header-anchor",href:"#auth"},"#")],-1),v=e("h4",{id:"multiple-providers"},[t("Multiple Providers "),e("a",{class:"header-anchor",href:"#multiple-providers"},"#")],-1),D=e("p",null,"You can configure multiple providers for handling authentication in Directus. This allows for different options when logging in. To do this, you can provide a CSV of provider names, and provide a config block for each of them:",-1),U=e("pre",null,[e("code",null,`AUTH_PROVIDERS="google,adobe"

AUTH_GOOGLE_DRIVER="openid"
AUTH_GOOGLE_CLIENT_ID="<google_application_id>"
AUTH_GOOGLE_CLIENT_SECRET= "<google_application_secret_key>"
AUTH_GOOGLE_ISSUER_URL="https://accounts.google.com"
AUTH_GOOGLE_ALLOW_PUBLIC_REGISTRATION="true"
AUTH_GOOGLE_DEFAULT_ROLE_ID="<directus_role_id>"
AUTH_GOOGLE_ICON="google"

AUTH_ADOBE_DRIVER="oauth2"
AUTH_ADOBE_CLIENT_ID="<adobe_application_id>"
AUTH_ADOBE_CLIENT_SECRET="<adobe_application_secret_key>"
AUTH_ADOBE_AUTHORIZE_URL="https://ims-na1.adobelogin.com/ims/authorize/v2"
AUTH_ADOBE_ACCESS_URL="https://ims-na1.adobelogin.com/ims/token/v3"
AUTH_ADOBE_PROFILE_URL="https://ims-na1.adobelogin.com/ims/userinfo/v2"
AUTH_ADOBE_ALLOW_PUBLIC_REGISTRATION="true"
AUTH_ADOBE_DEFAULT_ROLE_ID="<directus_role_id>"
AUTH_ADOBE_ICON="adobe"
`)],-1),H=e("h3",{id:"oauth-2.0-and-openid"},[t("OAuth 2.0 and OpenID "),e("a",{class:"header-anchor",href:"#oauth-2.0-and-openid"},"#")],-1),w=e("p",null,"Directus\u2019 OAuth 2.0 and OpenID integrations provide powerful alternative ways to authenticate into your project. Directus will ask you to login on the external service, and return authenticated with a Directus account linked to that service.",-1),G=e("p",null,[t("Directus supports hundreds of OAuth 2.0 and OpenID services, but requires some configuration to authenticate users correctly. For example, enabling authentication through GitHub requires creating an "),e("a",{href:"https://github.com/settings/developers",target:"_blank",rel:"noopener noreferrer"},"OAuth 2.0 app in GitHub"),t(" and adding the following configuration to Directus:")],-1),B=e("pre",null,[e("code",null,`AUTH_PROVIDERS="github"
AUTH_GITHUB_CLIENT_ID="99d3...c3c4"
AUTH_GITHUB_CLIENT_SECRET="34ae...f963"
AUTH_GITHUB_AUTHORIZE_URL="https://github.com/login/oauth/authorize"
AUTH_GITHUB_ACCESS_URL="https://github.com/login/oauth/access_token"
AUTH_GITHUB_PROFILE_URL="https://api.github.com/user"
`)],-1),k=e("div",{class:"warning hint"},[e("div",{class:"hint-title"},"PUBLIC_URL"),e("p",null,[t("These flows rely on the "),e("code",null,"PUBLIC_URL"),t(" variable for redirecting. Make sure that variable is configured correctly.")])],-1),N=e("h2",{id:"file-storage"},[t("File Storage "),e("a",{class:"header-anchor",href:"#file-storage"},"#")],-1),P=e("p",null,"By default, Directus stores every file you upload locally on disk. Instead of local file storage, you can configure Directus to use S3 or Google Cloud Storage instead:",-1),q=e("pre",null,[e("code",null,`STORAGE_LOCATIONS="aws"

STORAGE_AWS_DRIVER="s3"
STORAGE_AWS_KEY="tp15c...510vk"
STORAGE_AWS_SECRET="yk29b...b932n"
STORAGE_AWS_REGION="us-east-2"
STORAGE_AWS_BUCKET="my-files"
`)],-1),W=e("h3",{id:"multiple-storage-adapters"},[t("Multiple Storage Adapters "),e("a",{class:"header-anchor",href:"#multiple-storage-adapters"},"#")],-1),x=e("p",null,"You can configure multiple storage adapters at the same time. This allows you to choose where files are being uploaded on a file-by-file basis. To do this, you can provide a CSV of storage location names, and provide a config block for each of them:",-1),F=e("pre",null,[e("code",null,`STORAGE_LOCATIONS="local,aws"

STORAGE_LOCAL_DRIVER="local"
STORAGE_LOCAL_ROOT="local"

STORAGE_AWS_KEY="tp15c...510vk"
STORAGE_AWS_SECRET="yk29b...b932n"
STORAGE_AWS_REGION="us-east-2"
STORAGE_AWS_BUCKET="my-files"
`)],-1),M=e("p",null,[t("In the Admin App, files will automatically be uploaded to the first configured storage location (in this case "),e("code",null,"local"),t("). The used storage location is saved under "),e("code",null,"storage"),t(" in "),e("code",null,"directus_files"),t(".")],-1),V=e("h2",{id:"rate-limiting"},[t("Rate Limiting "),e("a",{class:"header-anchor",href:"#rate-limiting"},"#")],-1),Y=e("p",null,"You can use the built-in rate-limiter to prevent users from hitting the API too much. To enable the rate-limiter, simply set",-1),j=e("pre",null,[e("code",null,`RATE_LIMITER_ENABLED="true"
`)],-1),K=e("p",null,"This will kick-in the rate-limiter on a maximum of 50 requests a second. You can configure this using:",-1),z=e("pre",null,[e("code",null,`// 10 requests per 5 seconds

RATE_LIMITER_POINTS="10"
RATE_LIMITER_DURATION="5"
`)],-1),Z=e("p",null,[t("Once you have multiple copies of Directus running under a load-balancer, or your user base grows so much that memory is no longer a viable place to store the rate limiter information, you can use an external "),e("code",null,"memcache"),t(" or "),e("code",null,"redis"),t(" instance to store the rate limiter data:")],-1),J=e("pre",null,[e("code",null,`RATE_LIMITER_ENABLED="true"

RATE_LIMITER_POINTS="10"
RATE_LIMITER_DURATION="5"

RATE_LIMITER_STORE="redis"

RATE_LIMITER_REDIS="redis://@127.0.0.1"
`)],-1),Q=e("h2",{id:"file-based-configuration"},[t("File-Based Configuration "),e("a",{class:"header-anchor",href:"#file-based-configuration"},"#")],-1),X=t("In case you prefer using a configuration file instead of environment variables, you can use the "),$=e("code",null,"CONFIG_PATH",-1),ee=t(" environment variable to instruct Directus to use a local configuration file instead of environment variables. See "),te=t("Config Files"),oe=t(" for more information."),re={setup(ne,{expose:s}){const o={title:"Configuring the API",modularExtension:!1};return s({frontmatter:o}),(ae,se)=>{const i=n("router-link"),r=n("DocsWrapper");return l(),c(r,{frontmatter:o},{default:a(()=>[e("div",h,[_,d,p,f,T,E,g,A,m,R,O,I,b,L,C,S,y,v,D,U,H,w,G,B,k,N,P,q,W,x,F,M,V,Y,j,K,z,Z,J,Q,e("p",null,[X,$,ee,u(i,{to:"/docs/reference/config-files.md"},{default:a(()=>[te]),_:1}),oe])])]),_:1})}}};export{re as default};
